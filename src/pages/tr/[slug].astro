---
import Base from '../../layouts/Base.astro';
import { getCollection } from 'astro:content';
const BASE = import.meta.env.BASE_URL;

export async function getStaticPaths() {
  const posts = await getCollection('posts', p => p.data.lang === 'tr' && !p.data.draft);
  return posts.map((p) => {
    const slug = p.slug.replace(/^tr\//, '');   // << important
    return { params: { slug }, props: { post: p } };
  });
}

const { post } = Astro.props;
---
<Base title={post.data.title} lang="tr">
  <h1>{post.data.title}</h1>
  <p><small>{post.data.pubDate.toISOString().slice(0,10)}</small></p>
  <article set:html={post.body} />
  {post.data.translationOf && (
    <p>English version:
      <a href={`${BASE}en/${post.data.translationOf}/`}>/en/{post.data.translationOf}</a>
    </p>
  )}
</Base>
